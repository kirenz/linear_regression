
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Linear regression &#8212; Introduction to Regression Models</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Regression diagnostics" href="diagnostics.html" />
    <link rel="prev" title="Welcome" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Introduction to Regression Models</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Linear regression
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Diagnostics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="diagnostics.html">
   Regression diagnostics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lasso, Splines &amp; GAM
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="hitters_data.html">
   Hitters data preparation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lasso.html">
   Lasso regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="splines.html">
   Regression splines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gam.html">
   Generalized Additive Models (GAM)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Decision Trees
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="randomforest.html">
   Random forest in scikit-learn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gradientboosting.html">
   Gradient Boosting in scikit-learn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gradientboosting-xgboost.html">
   Gradient Boosting with XGBoost
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Combine predictors
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ensemble.html">
   Ensemble meta-estimator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stacking.html">
   Stacking
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Case Duke
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="case-duke.html">
   Case study
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="case-duke-exploration.html">
   Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="case-duke-data-prep-template.html">
   Create data prep file
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="case-duke-statsmodel.html">
   Statsmodels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="case-duke-sklearn.html">
   Scikit-learn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="case-duke-tensorflow.html">
   TensorFlow
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Case Happy
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ds-happy-stats.html">
   Simple statsmodels model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ds-happy-scikit.html">
   Simple scikit learn model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="reference.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/basics.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kirenz/regression"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kirenz/regression/issues/new?title=Issue%20on%20page%20%2Fdocs/basics.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/kirenz/regression/blob/main/docs/basics.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python-setup">
   Python setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-data">
   Import data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tidying-data">
   Tidying data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transform-data">
   Transform data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualize-data">
   Visualize data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model">
   Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean">
   Mean
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-model">
   Regression model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quality-of-fit">
   Quality of fit
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#residuals-and-r-2">
   Residuals and
   <span class="math notranslate nohighlight">
    \(R^2\)
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Mean
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression">
     Regression
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pearson-s-correlation-coefficient">
     Pearson’s correlation coefficient
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mean-squared-error">
     Mean squared error
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variance">
     Variance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#f-statistic">
     F-Statistic
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#standard-error">
     Standard error
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#significance-testing">
     Significance testing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#confidence-interval">
     Confidence interval
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#confidence-intervals-in-small-samples">
     Confidence intervals in small samples
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-measures">
   Additional measures
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bayesian-information-criterion-bic">
     Bayesian information criterion (BIC)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#akaike-information-criterion-aic">
     Akaike information criterion (AIC)
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Linear regression</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python-setup">
   Python setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-data">
   Import data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tidying-data">
   Tidying data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transform-data">
   Transform data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualize-data">
   Visualize data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model">
   Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean">
   Mean
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-model">
   Regression model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quality-of-fit">
   Quality of fit
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#residuals-and-r-2">
   Residuals and
   <span class="math notranslate nohighlight">
    \(R^2\)
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Mean
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression">
     Regression
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pearson-s-correlation-coefficient">
     Pearson’s correlation coefficient
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mean-squared-error">
     Mean squared error
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variance">
     Variance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#f-statistic">
     F-Statistic
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#standard-error">
     Standard error
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#significance-testing">
     Significance testing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#confidence-interval">
     Confidence interval
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#confidence-intervals-in-small-samples">
     Confidence intervals in small samples
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-measures">
   Additional measures
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bayesian-information-criterion-bic">
     Bayesian information criterion (BIC)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#akaike-information-criterion-aic">
     Akaike information criterion (AIC)
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="linear-regression">
<h1>Linear regression<a class="headerlink" href="#linear-regression" title="Permalink to this headline">¶</a></h1>
<p><em>The explanations of statistical concepts are partly based on <span id="id1">Field [<a class="reference internal" href="reference.html#id3" title="Andy Field. Discovering statistics using IBM SPSS statistics. sage, 2013.">2013</a>]</span></em></p>
<p>Linear regression is the fundamental starting point for all regression methods and it is still a useful and widely used statistical learning method. Moreover, it serves as a good jumping point for newer approaches. Consequently, the importance of having a good understanding of linear regression before studying more complex learning methods cannot be overstated <span id="id2">[<a class="reference internal" href="reference.html#id7" title="Gareth James, Daniela Witten, Trevor Hastie, and Robert Tibshirani. An Introduction to Statistical learning. Springer, 2021. URL: https://www.statlearning.com/.">James <em>et al.</em>, 2021</a>]</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Linear regression is a useful tool for predicting a quantitative response</p>
</div>
<p>One of the simplest models we use in statistics is the <strong>mean</strong>. It is a (simple) model because it represents a summary of data. Therefore, let’s use the mean as a baseline model and compare the quality of fit between the mean and a simple linear regression model with only one predictor.</p>
<p>We use a small sample of 20 women from whom we obtained their height (this is our outcome variable) and the average height of their parents (this is our feature).</p>
<div class="section" id="python-setup">
<h2>Python setup<a class="headerlink" href="#python-setup" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline 
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>  

<span class="c1"># seaborn settings</span>
<span class="n">custom_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;axes.spines.right&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;axes.spines.top&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="n">rc</span><span class="o">=</span><span class="n">custom_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="import-data">
<h2>Import data<a class="headerlink" href="#import-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import data</span>
<span class="n">ROOT</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/kirenz/modern-statistics/main/data/&quot;</span>
<span class="n">DATA</span> <span class="o">=</span> <span class="s2">&quot;height-clean.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">ROOT</span> <span class="o">+</span> <span class="n">DATA</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show the first rows (i.e. head of the DataFrame)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>average_height_parents</th>
      <th>gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
      <td>female</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Peter</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
      <td>male</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
      <td>female</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
      <td>female</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Simon</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
      <td>male</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show last rows</span>
<span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>average_height_parents</th>
      <th>gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15</th>
      <td>Marc</td>
      <td>16</td>
      <td>166</td>
      <td>166</td>
      <td>male</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Ralph</td>
      <td>17</td>
      <td>166</td>
      <td>166</td>
      <td>male</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Tom</td>
      <td>18</td>
      <td>167</td>
      <td>166</td>
      <td>male</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Steven</td>
      <td>19</td>
      <td>167</td>
      <td>167</td>
      <td>male</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Emanuel</td>
      <td>20</td>
      <td>168</td>
      <td>168</td>
      <td>male</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data overview (with meta data)</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 20 entries, 0 to 19
Data columns (total 5 columns):
 #   Column                  Non-Null Count  Dtype 
---  ------                  --------------  ----- 
 0   name                    20 non-null     object
 1   id                      20 non-null     int64 
 2   height                  20 non-null     int64 
 3   average_height_parents  20 non-null     int64 
 4   gender                  20 non-null     object
dtypes: int64(3), object(2)
memory usage: 928.0+ bytes
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show all variables in the data set</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;name&#39;, &#39;id&#39;, &#39;height&#39;, &#39;average_height_parents&#39;, &#39;gender&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tidying-data">
<h2>Tidying data<a class="headerlink" href="#tidying-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># change data type</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">])</span>

<span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;average_height_parents&quot;</span><span class="p">:</span> <span class="s2">&quot;height_parents&quot;</span><span class="p">},</span>
    <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show missing values (missing values - if present - will be displayed in yellow )</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span><span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_12_0.png" src="../_images/basics_12_0.png" />
</div>
</div>
<p>We can also check the column-wise distribution of null values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>name              0
id                0
height            0
height_parents    0
gender            0
dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="transform-data">
<h2>Transform data<a class="headerlink" href="#transform-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># summary statistics for all numerical columns (in transposed view)</span>
<span class="nb">round</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>height</th>
      <td>20.0</td>
      <td>165.00</td>
      <td>1.49</td>
      <td>162.0</td>
      <td>164.0</td>
      <td>165.0</td>
      <td>166.0</td>
      <td>168.0</td>
    </tr>
    <tr>
      <th>height_parents</th>
      <td>20.0</td>
      <td>165.05</td>
      <td>1.67</td>
      <td>161.0</td>
      <td>164.0</td>
      <td>165.0</td>
      <td>166.0</td>
      <td>168.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grouped summary statistics for all numerical columns (in transposed view)</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;gender&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gender</th>
      <th>female</th>
      <th>male</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="8" valign="top">height</th>
      <th>count</th>
      <td>11.000000</td>
      <td>9.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>164.363636</td>
      <td>165.777778</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.120065</td>
      <td>1.563472</td>
    </tr>
    <tr>
      <th>min</th>
      <td>162.000000</td>
      <td>163.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>164.000000</td>
      <td>165.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>165.000000</td>
      <td>166.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>165.000000</td>
      <td>167.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>166.000000</td>
      <td>168.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">height_parents</th>
      <th>count</th>
      <td>11.000000</td>
      <td>9.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>164.636364</td>
      <td>165.555556</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.629278</td>
      <td>1.666667</td>
    </tr>
    <tr>
      <th>min</th>
      <td>161.000000</td>
      <td>163.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>164.000000</td>
      <td>165.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>165.000000</td>
      <td>166.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>165.500000</td>
      <td>166.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>167.000000</td>
      <td>168.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># summary statistics for all categorical columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20</td>
      <td>20</td>
      <td>20</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>19</td>
      <td>20</td>
      <td>2</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>female</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>2</td>
      <td>1</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="visualize-data">
<h2>Visualize data<a class="headerlink" href="#visualize-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># histogram with seaborn</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_20_0.png" src="../_images/basics_20_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># histogram with seaborn</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;gender&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_21_0.png" src="../_images/basics_21_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># boxplot</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_22_0.png" src="../_images/basics_22_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># boxplot</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;gender&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_23_0.png" src="../_images/basics_23_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check relationship with a joint plot</span>
<span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;height_parents&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_24_0.png" src="../_images/basics_24_0.png" />
</div>
</div>
<p>We can observe a strong positive relationship between height and the average height of the parents. Hence, it would make sense to use the variable <code class="docutils literal notranslate"><span class="pre">height_parents</span></code> as a predictor for the outcome variable <code class="docutils literal notranslate"><span class="pre">height</span></code> in a statistical model.</p>
</div>
<div class="section" id="model">
<h2>Model<a class="headerlink" href="#model" title="Permalink to this headline">¶</a></h2>
<p>If we are interested in discovering something about a phenomenon in the real world, we need to collect data to test predictions from our hypotheses about that phenomenon. Testing these hypotheses involves building statistical <strong>models</strong> of the phenomenon of interest.</p>
<p>It is important that the model accurately represents the real world, otherwise any conclusions we extrapolate to the real-world will be meaningless. Hence, the statistical model should represent the data collected (the observed data) as closely as possible.</p>
<div class="math notranslate nohighlight">
\[Outcome_i = (Model) + error_i\]</div>
<p>This equation means that the data we observe can be predicted from the model we choose to fit plus some amount of error. There are different terms that basically refer to <strong>error</strong> like <strong>residual</strong>, <strong>deviation</strong> or <strong>deviance</strong>. The degree to which a statistical model represents the data collected is known as the <strong>fit of the model</strong> which is closely related to the error of the model.</p>
<p>The model in the equation will vary depending on the design of your study, the type of data you have and what it is you’re trying to achieve with your model. Consequently, the model can also vary in its complexity.</p>
<p>The important thing is that we can use the model computed in our <strong>sample</strong> to estimate the value in the <strong>population</strong> (which is the value in which we’re interested).</p>
<p><strong>Parameters</strong></p>
<p>Statistical models are made up of <strong>variables</strong> and <strong>parameters</strong>. Variables are measured constructs that vary across entities in the sample. In contrast, parameters are not measured and are (usually) constants believed to represent some fundamental truth about the relations between variables in the model.</p>
<p>Some examples of parameters with which you already are familiar are: the <strong>mean</strong> and <strong>median</strong> (which estimate the centre of the distribution). We will also cover correlation and regression coefficients (which estimate the relationship between two variables) in other applications.</p>
<p>If we’re interested only in summarizing the outcome, as we are when we compute a <strong>mean</strong>, then we won’t have any variables in the model, only a <strong>parameter</strong> (typically called <em>b</em>), so we could write our <span class="math notranslate nohighlight">\(Outcome_i = (Model) + error_i\)</span> equation as:</p>
<p><span class="math notranslate nohighlight">\(Outcome_i = (b) + error_i\)</span></p>
<p>Let’s say we would like to compare the <strong>quality of fit</strong> of two models to predict the height of women in our dataset: the simple mean and a second model in which we use information about the average height of their parents as a predictor in a linear regression model.</p>
<p><strong>Model 1: Mean</strong></p>
<ul class="simple">
<li><p>In the case of the <strong>mean</strong>, the <em>b</em> parameter is usually called <span class="math notranslate nohighlight">\(\bar{x}\)</span>, which leads to:</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(height_i = (\bar{x}) + error_i\)</span></p>
<ul class="simple">
<li><p>with</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\bar{x} =  \frac {\sum_{i=1}^n x_{i}}{n}\)</span></p>
<p><strong>Model 2: Linear Regression</strong></p>
<ul class="simple">
<li><p>In our second model, we use the variable height of parents as predictor in a linear regression model:</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(height_i = (b_0 + b_1 \times heightparents_i ) + error_i\)</span></p>
</div>
<div class="section" id="mean">
<h2>Mean<a class="headerlink" href="#mean" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate the mean </span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>165.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add the mean (we call it &quot;average&quot;) to our DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">average</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>height_parents</th>
      <th>gender</th>
      <th>average</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
      <td>female</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Peter</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
      <td>male</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
      <td>female</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
      <td>female</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Simon</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
      <td>male</td>
      <td>165.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a scatterplot (plt)</span>
<span class="n">plt</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;height&quot;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">);</span>

<span class="c1"># labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Height in cm&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Error of the model&#39;</span><span class="p">);</span>

<span class="c1"># add our model </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">165</span><span class="p">,</span> <span class="mi">165</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">165.2</span><span class="p">,</span><span class="s1">&#39;mean = 165&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_31_0.png" src="../_images/basics_31_0.png" />
</div>
</div>
</div>
<div class="section" id="regression-model">
<h2>Regression model<a class="headerlink" href="#regression-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fit linear model with statsmodels.formula.api</span>
<span class="n">lm</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span><span class="s1">&#39;height ~ height_parents&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># add the regression predictions (as &quot;pred&quot;) to our DataFrame</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>height_parents</th>
      <th>gender</th>
      <th>average</th>
      <th>pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
      <td>female</td>
      <td>165.0</td>
      <td>161.711048</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Peter</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
      <td>male</td>
      <td>165.0</td>
      <td>163.335222</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
      <td>female</td>
      <td>165.0</td>
      <td>163.335222</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
      <td>female</td>
      <td>165.0</td>
      <td>164.959396</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Simon</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
      <td>male</td>
      <td>165.0</td>
      <td>163.335222</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># summary of regression results</span>
<span class="n">lm</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>height</td>      <th>  R-squared:         </th> <td>   0.831</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.822</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   88.78</td>
</tr>
<tr>
  <th>Date:</th>             <td>Sun, 05 Dec 2021</td> <th>  Prob (F-statistic):</th> <td>2.21e-08</td>
</tr>
<tr>
  <th>Time:</th>                 <td>13:23:53</td>     <th>  Log-Likelihood:    </th> <td> -17.995</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    20</td>      <th>  AIC:               </th> <td>   39.99</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    18</td>      <th>  BIC:               </th> <td>   41.98</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
         <td></td>           <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>      <td>   30.9651</td> <td>   14.226</td> <td>    2.177</td> <td> 0.043</td> <td>    1.077</td> <td>   60.853</td>
</tr>
<tr>
  <th>height_parents</th> <td>    0.8121</td> <td>    0.086</td> <td>    9.422</td> <td> 0.000</td> <td>    0.631</td> <td>    0.993</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 4.700</td> <th>  Durbin-Watson:     </th> <td>   1.384</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.095</td> <th>  Jarque-Bera (JB):  </th> <td>   2.492</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.684</td> <th>  Prob(JB):          </th> <td>   0.288</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.058</td> <th>  Cond. No.          </th> <td>1.67e+04</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.67e+04. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is just a simple example of how regression works.</span>

<span class="c1"># our parameters</span>
<span class="n">b_0</span> <span class="o">=</span> <span class="mf">30.9651</span>
<span class="n">b_1</span> <span class="o">=</span> <span class="mf">0.8121</span>

<span class="c1"># Make a prediction for X=200</span>
<span class="n">X</span> <span class="o">=</span> <span class="mi">200</span>

<span class="n">prediction</span> <span class="o">=</span> <span class="n">b_0</span> <span class="o">+</span> <span class="n">b_1</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>193.39
</pre></div>
</div>
</div>
</div>
<p>We use <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.lmplot.html">Seaborn’s lmplot</a> to plot the regression line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot regression line </span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;height_parents&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">},</span> <span class="n">height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_38_0.png" src="../_images/basics_38_0.png" />
</div>
</div>
</div>
<div class="section" id="quality-of-fit">
<h2>Quality of fit<a class="headerlink" href="#quality-of-fit" title="Permalink to this headline">¶</a></h2>
<p>In order to evaluate the performance of a statistical model on a given data set, we need some way to measure how well its predictions actually match the observed data. That is, we need to quantify the extent to which the predicted response value for a given observation is close to
the true response value for that observation.</p>
<p>With most statistical models we can determine whether the model represents the data well by looking at how different the scores we observed in the data are from the values that the model predicts.</p>
<div class="math notranslate nohighlight">
\[observed_i = model_i + error_i\]</div>
<p>hence</p>
<div class="math notranslate nohighlight">
\[error_i = observed_i - model_i\]</div>
<p>In other words, the error for a particular entity is the score predicted by the model for that entity subtracted from the corresponding observed score.</p>
</div>
<div class="section" id="residuals-and-r-2">
<h2>Residuals and <span class="math notranslate nohighlight">\(R^2\)</span><a class="headerlink" href="#residuals-and-r-2" title="Permalink to this headline">¶</a></h2>
<p>Note that residuals (errors) would cancel out because some are positive and others negative. Therefore, we square each deviation. If we add these squared deviations we get the <strong>sum of squared residuals (SSR)</strong> (also known as the residual sum of squares (RSS) or the sum of squared estimate of errors (SSE)).</p>
<p><span class="math notranslate nohighlight">\( SSR = \sum_{i=1}^n (observed_i - model_i)^2\)</span></p>
<p>Using the <strong>mean</strong> of the outcome as a baseline model, we can calculate the difference between the observed values and the values predicted by the mean. We square these differences to give us the sum of squared differences. This sum of squared differences is known as the <strong>total sum of squares</strong> (denoted by <span class="math notranslate nohighlight">\(TSS\)</span>) and it represents how good the mean is as a model of the observed outcome scores:</p>
<div class="math notranslate nohighlight">
\[TSS = \sum_{i=1}^n (observed_i - mean)^2\]</div>
<p>We can use the values of <span class="math notranslate nohighlight">\(TSS\)</span> and the sum of squared residuals (<span class="math notranslate nohighlight">\(SSR\)</span>)</p>
<div class="math notranslate nohighlight">
\[SSR =  \sum_{i=1}^n (observed_i - model_i )^2\]</div>
<p>to calculate how much better the linear regression model is than the baseline model (the mean). The improvement in prediction resulting from using the linear model rather than the mean is calculated as the difference between <span class="math notranslate nohighlight">\(TSS\)</span> and <span class="math notranslate nohighlight">\(SSR\)</span>.</p>
<p>This difference shows us the reduction in the inaccuracy of the mean model resulting from fitting the regression model to the data. This improvement is the <strong>model sum of squares</strong> <span class="math notranslate nohighlight">\(SSM\)</span> (also known as explained sum of squares (ESS))</p>
<div class="math notranslate nohighlight">
\[SSM = TSS - SSR\]</div>
<ul class="simple">
<li><p>If the value of <span class="math notranslate nohighlight">\(SSM\)</span> is <em>large</em>, then the linear model is very different from using the mean to predict the outcome variable. This implies that the linear model has made a big improvement to predicting the outcome variable.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(SSM\)</span> is <em>small</em> then using the linear model is little better than using the mean (i.e., the model is no better than predicting from ‘no relationship’).</p></li>
</ul>
<p>A useful measure arising from these sums of squares is the proportion of improvement due to the model. This is calculated by dividing the sum of squares for the model (SSR) by the total sum of squares (TSS) to give a quantity called <span class="math notranslate nohighlight">\(R^2\)</span></p>
<div class="math notranslate nohighlight">
\[R^2 = \frac {SS_M}{TSS}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[TSS =  \sum_{i=1}^n (observed_i - mean)^2\]</div>
<div class="math notranslate nohighlight">
\[SSR =  \sum_{i=1}^n (observed_i - model_i )^2\]</div>
<div class="math notranslate nohighlight">
\[SSM = TSS - SS_R\]</div>
<p>To express the <span class="math notranslate nohighlight">\(R^2\)</span>-value as a percentage multiply it by 100.</p>
<p><span class="math notranslate nohighlight">\(R^2\)</span> represents the amount of variance in the outcome explained by the model (<span class="math notranslate nohighlight">\(SSM\)</span>) relative to how much variation there was to explain in the first place (<span class="math notranslate nohighlight">\(TSS\)</span>):</p>
<ul class="simple">
<li><p>it represents the proportion of the variation in the outcome that can be predicted from the model.</p></li>
<li><p>Therefore, it can take any value between 0% and 100%.</p></li>
</ul>
<p><strong>Adjusted</strong> <span class="math notranslate nohighlight">\(R^2\)</span>:</p>
<p>Whereas <span class="math notranslate nohighlight">\(R^2\)</span> tells us how much of the variance in Y overlaps with predicted values from the model in our sample, adjusted <span class="math notranslate nohighlight">\(R^2\)</span> tells us how much variance in Y would be accounted for if the model had been derived from the <strong>population</strong> from which the sample was taken (takes degrees of freedom into account). Therefore, the adjusted value indicates the loss of predictive power or shrinkage.</p>
<p>As a general rule it is preferrable to use the adjusted <span class="math notranslate nohighlight">\(R^2\)</span> instead of the simple <span class="math notranslate nohighlight">\(R^2\)</span>.</p>
<div class="section" id="id3">
<h3>Mean<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate error (observation - average) and assign it to dataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">error</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">]))</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>height_parents</th>
      <th>gender</th>
      <th>average</th>
      <th>pred</th>
      <th>error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
      <td>female</td>
      <td>165.0</td>
      <td>161.711048</td>
      <td>-3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Peter</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
      <td>male</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
      <td>female</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
      <td>female</td>
      <td>165.0</td>
      <td>164.959396</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Simon</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
      <td>male</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note, that we can’t simply add deviances (the individual errors) because some errors are positive and others negative and so we’d get a total of zero.</p>
<p>total error = sum of errors</p>
<p>total error <span class="math notranslate nohighlight">\(= \sum_{i=1}^n (outcome_i - model_i)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate the sum of the errors </span>
<span class="n">df</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a scatterplot (plt)</span>
<span class="n">plt</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;height&quot;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Height in cm&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Error of th model&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">165</span><span class="p">,</span> <span class="mi">165</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">165.2</span><span class="p">,</span><span class="s1">&#39;mean = 165&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_47_0.png" src="../_images/basics_47_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># residual plot</span>
<span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">});</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_48_0.png" src="../_images/basics_48_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate squared error and assign it to dataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">error_sq</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>height_parents</th>
      <th>gender</th>
      <th>average</th>
      <th>pred</th>
      <th>error</th>
      <th>error_sq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
      <td>female</td>
      <td>165.0</td>
      <td>161.711048</td>
      <td>-3.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Peter</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
      <td>male</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
      <td>female</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
      <td>female</td>
      <td>165.0</td>
      <td>164.959396</td>
      <td>-1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Simon</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
      <td>male</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate sum of squared error (which is in case of the mean the total error)</span>
<span class="n">TSS</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">error_sq</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="c1"># print output</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sum of squared error (TSS) of model 1:&#39;</span><span class="p">,</span> <span class="n">TSS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sum of squared error (TSS) of model 1: 42.0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="regression">
<h3>Regression<a class="headerlink" href="#regression" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm</span><span class="o">.</span><span class="n">resid</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.206412995699793e-12
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># obtain the residuals from statsmodel (resid)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;error_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">resid</span>
<span class="c1"># square the residuals </span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;error_sq_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;error_2&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="c1"># show df</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>height_parents</th>
      <th>gender</th>
      <th>average</th>
      <th>pred</th>
      <th>error</th>
      <th>error_sq</th>
      <th>error_2</th>
      <th>error_sq_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
      <td>female</td>
      <td>165.0</td>
      <td>161.711048</td>
      <td>-3.0</td>
      <td>9.0</td>
      <td>0.288952</td>
      <td>0.083493</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Peter</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
      <td>male</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-2.0</td>
      <td>4.0</td>
      <td>-0.335222</td>
      <td>0.112374</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
      <td>female</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-2.0</td>
      <td>4.0</td>
      <td>-0.335222</td>
      <td>0.112374</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
      <td>female</td>
      <td>165.0</td>
      <td>164.959396</td>
      <td>-1.0</td>
      <td>1.0</td>
      <td>-0.959396</td>
      <td>0.920440</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Simon</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
      <td>male</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-1.0</td>
      <td>1.0</td>
      <td>0.664778</td>
      <td>0.441930</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Total sum of squares (TSS: sum of squared errors of the base model, i.e. the mean)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">TSS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>42.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sum of squared residuals (SS_R)</span>
<span class="n">SSR</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;error_sq_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">SSR</span><span class="p">)</span>
<span class="c1"># SSR – Sum of squared residuals from statsmodel function</span>
<span class="n">lm</span><span class="o">.</span><span class="n">ssr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.0802644003777155
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.080264400377715
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot regression line </span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;height_parents&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">},</span> <span class="n">height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_56_0.png" src="../_images/basics_56_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;height_parents&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">});</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_57_0.png" src="../_images/basics_57_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Explained sum of squares  (SS_M = TSS - SS_R)</span>
<span class="n">SSM</span> <span class="o">=</span> <span class="n">TSS</span> <span class="o">-</span> <span class="n">SSR</span>
<span class="nb">print</span><span class="p">(</span><span class="n">SSM</span><span class="p">)</span>
<span class="c1"># Explained sum of squres (SS_M) from statsmodel function</span>
<span class="n">lm</span><span class="o">.</span><span class="n">ess</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>34.919735599622285
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>34.919735599622285
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(R^2\)</span> is the proportion of the variance in the dependent variable that is predictable from the independent variable</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># R_Squared: explained sum of squared residuals</span>
<span class="n">R_squared</span> <span class="o">=</span> <span class="n">SSM</span> <span class="o">/</span> <span class="n">TSS</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R_squared</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.831422276181483
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># R_Squared of statsmodel</span>
<span class="n">lm</span><span class="o">.</span><span class="n">rsquared</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.831422276181483
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adjusted R_Squared: </span>
<span class="n">lm</span><span class="o">.</span><span class="n">rsquared_adj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8220568470804543
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pearson-s-correlation-coefficient">
<h3>Pearson’s correlation coefficient<a class="headerlink" href="#pearson-s-correlation-coefficient" title="Permalink to this headline">¶</a></h3>
<p>We just saw that <span class="math notranslate nohighlight">\(R^2\)</span> represents the proportion of the variation in the outcome that can be predicted from the model:</p>
<p><span class="math notranslate nohighlight">\(R^2 = \frac{SSM}{TSS}\)</span></p>
<p>with</p>
<p><span class="math notranslate nohighlight">\(TSS =  \sum_{i=1}^n (observed_i - mean)^2\)</span></p>
<p><span class="math notranslate nohighlight">\(SSR =  \sum_{i=1}^n (observed_i - model_i )^2\)</span></p>
<p><span class="math notranslate nohighlight">\(SSM = TSS - SSR\)</span></p>
<p>We can take the square root of this value to obtain <strong>Pearson’s correlation coefficient</strong> (we cover the topic of correlation in a separate application in detail) for the relationship between the values of the outcome predicted by the model and the observed values of the outcome. With only one predictor in the model this value will be the same as the Pearson correlation coefficient between the predictor and outcome variable.</p>
<p><span class="math notranslate nohighlight">\(r = \sqrt{R^2} = \sqrt{\frac{SSM}{TSS}}\)</span></p>
<p>As such, the correlation coefficient provides us with a good estimate of the overall fit of the regression model (i.e., the correspondence between predicted values of the outcome and the actual values), and <span class="math notranslate nohighlight">\(R^2\)</span> provides us with a gauge of the substantive size of the model fit.</p>
<p><strong>Interpretation of r:</strong></p>
<p><span class="math notranslate nohighlight">\(- 1 ≤ r ≤ 1\)</span></p>
<p>With a perfect relationship (r = −1 or 1) the observed data basically fall exactly on the line (the model is a perfect fit to the data), but for a weaker relationship (r = −0.5 or 0.5) the observed data are scattered more widely around the line.</p>
<ul class="simple">
<li><p>| r | = 0.10 (small effect)</p></li>
<li><p>| r | = 0.30 (medium effect)</p></li>
<li><p>| r | = 0.50 (large effect)</p></li>
</ul>
<p>It’s worth bearing in mind that r is not measured on a linear scale, so an effect with r = 0.6 isn’t twice as big as one with r = 0.3.</p>
<p>Let`s caculate the <span class="math notranslate nohighlight">\(R^2\)</span> for our regression model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># correlation coefficient r</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">R_squared</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.911823599267689
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># correlation coefficient with p-value</span>
<span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;height_parents&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.9118235992676889, 2.2144128916549524e-08)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="mean-squared-error">
<h3>Mean squared error<a class="headerlink" href="#mean-squared-error" title="Permalink to this headline">¶</a></h3>
<p>Although the <strong>sum of squared errors (SS)</strong> is a good measure of the accuracy of our model, it depends upon the quantity of data that has been collected – the more data points, the higher the SS.</p>
<p>By using the <strong>average error</strong>, rather than the total, we can overcome this problem. This measure is called the “<strong>Mean Squared Error (MSE)</strong>”. In the regression setting, it is the most commonly-used measure to evaluate the performance of a model.</p>
<p>To compute the average error we divide the sum of squares by the number of values that we used to compute that total. We again come back to the problem that we’re usually interested in the error in the model in the <strong>population</strong> (not the <strong>sample</strong>).</p>
<p>To estimate the mean error in the population we need to divide not by the number of scores contributing to the total, but by the <strong>degrees of freedom (df)</strong>, which is the number of scores used to compute the total adjusted for the fact that we’re trying to estimate the population value. Note: you may encounter different formulas for calculating the mse. Some only devide by the number of observations and not the df.</p>
<p>Mean squared error of our regression model:</p>
<div class="math notranslate nohighlight">
\[ MSE = \frac {SS}{df} = \frac {\sum_{i=1}^n (outcome_i - model_i)^2}{df}\]</div>
</div>
<div class="section" id="variance">
<h3>Variance<a class="headerlink" href="#variance" title="Permalink to this headline">¶</a></h3>
<p>In the case of our mean model, we use the <strong>variance</strong> as a measure of dispersion. Furthermore, the <strong>standard deviation</strong> is the square root of the variance:</p>
<p>Variance = <span class="math notranslate nohighlight">\(s^2 = \frac {SS}{df} = \frac {\sum_{i=1}^n (outcome_i - model_i)^2}{df}\)</span></p>
<p>Standard Deviation = <span class="math notranslate nohighlight">\(\sqrt{s^2} = \sqrt{\frac{\sum\limits_{i=1}^{n} \left(x_{i} - \bar{x}\right)^{2}} {df}}\)</span></p>
<p>which equals:</p>
<p><span class="math notranslate nohighlight">\(s =  \frac {\sum_{i=1}^n (outcome_i - model_i)}{df}\)</span></p>
<p>A small <strong>standard deviation</strong> represents a scenario in which most data points are close to the mean, whereas a large standard deviation represents a situation in which data points are widely spread from the mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate variance of the model mean</span>
<span class="c1"># Number of obeservations (lenght of DataFrame)</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">])</span>
<span class="c1"># calculate </span>
<span class="n">variance</span> <span class="o">=</span> <span class="p">(</span><span class="n">TSS</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="c1"># print output</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;variance of the mean:&#39;</span><span class="p">,</span> <span class="n">variance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>variance of the mean: 2.210526315789474
</pre></div>
</div>
</div>
</div>
<p>Variance =  <span class="math notranslate nohighlight">\(\frac {SS}{df} = \frac {\sum_{i=1}^n (outcome_i - model_i)^2}{df} = \frac {\sum_{i=1}^n(x_i-\bar{x})^2}{df} = \frac {42}{19} = 2.210\)</span></p>
<p>In our example, <span class="math notranslate nohighlight">\(n=20\)</span>, we have one parameter, p=1 (the mean), and therefore, the degrees of freedom are df = (p-1) = 20-1 = 19.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># obtain the standard deviation</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Standard deviation (SD) of model 1 = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">variance</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Standard deviation (SD) of model 1 = 1.49
</pre></div>
</div>
</div>
</div>
<p>Linear Regression:</p>
<p>Statsmodel provide us with different options (we use mse_resid and mse_total):</p>
<ul class="simple">
<li><p>mse_model : Mean squared error the model. This is the explained sum of squares divided by the model degrees of freedom.</p></li>
<li><p>mse_resid : Mean squared error of the residuals. The sum of squared residuals divided by the residual degrees of freedom.</p></li>
<li><p>mse_total : Total mean squared error. Defined as the uncentered total sum of squares divided by n the number of observations.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Total MSE_T (this is the MSE of the basline mean model) from statsmodel</span>
<span class="n">MSE_T</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">mse_total</span>
<span class="c1"># print output</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total mean squared error (MSE_T):&#39;</span><span class="p">,</span> <span class="n">MSE_T</span><span class="p">)</span>
<span class="c1"># compare this result to mse... they are the same</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total mean squared error (MSE_T): 2.210526315789474
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mean squared error of residuals (MSE_R)</span>
<span class="n">MSE_R</span> <span class="o">=</span> <span class="n">SSR</span> <span class="o">/</span> <span class="p">(</span><span class="mi">20</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean squared error of residuals (MSE_R):&#39;</span><span class="p">,</span> <span class="n">MSE_R</span><span class="p">)</span>
<span class="c1"># MSE of residuals from statsmodel (preferred)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean squared error od residuals (MSE_R): </span><span class="si">{</span><span class="n">lm</span><span class="o">.</span><span class="n">mse_resid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean squared error of residuals (MSE_R): 0.3933480222432064
Mean squared error od residuals (MSE_R): 0.39334802224320636
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the standard deviation equals the root of the MSE_R</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Standard deviation (SD) of model 2 = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">MSE_R</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Standard deviation (SD) of model 2 = 0.63
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="f-statistic">
<h3>F-Statistic<a class="headerlink" href="#f-statistic" title="Permalink to this headline">¶</a></h3>
<p>A second use of the sums of squares in assessing the model is the <strong>F-test</strong>. Test statistics (like F) are usually the amount of <strong>systematic variance</strong> divided by the amount of <strong>unsystematic variance</strong>, or, put another way, the model compared to the error in the model. This is true here: F is based upon the ratio of the improvement due to the model (<span class="math notranslate nohighlight">\(SS_M\)</span>) and the error in the model (<span class="math notranslate nohighlight">\(SS_R\)</span>).</p>
<p>Because the sums of squares depend on the number of differences that were added up, the <strong>average sums of squares</strong> (referred to as the <strong>mean squares</strong> or <strong>MS</strong>) are used to compute F.</p>
<p>The <strong>mean sum of squares</strong> is the sum of squares divided by the associated degrees of freedom (this is comparable to calculating the variance from the sums of squares).</p>
<p>For <span class="math notranslate nohighlight">\(SS_M\)</span> the degrees of freedom are the number of predictors in the model (<em>p</em>), and for <span class="math notranslate nohighlight">\(SS_R\)</span> they are the number of observations (<em>n</em>) minus the number of parameters being estimated (i.e., the number of b coefficients including the constant).</p>
<p>We estimate a “b” for each predictor and the intercept (<span class="math notranslate nohighlight">\(b_0\)</span>), so the total number of b’s estimated will be <em>p + 1</em>, giving us degrees of freedom of n - (p + 1) or, more simply, n - p - 1. Thus:</p>
<p><span class="math notranslate nohighlight">\(MS_M = \frac{SS_M}{p}\)</span></p>
<p><span class="math notranslate nohighlight">\(MS_R = \frac{SS_R}{n-p-1}\)</span></p>
<p><strong>The F-statistic computed from these mean squares</strong></p>
<div class="math notranslate nohighlight">
\[F = \frac{Systematic Variance}{Unsystematic Variance} = \frac{MS_M}{MS_R}\]</div>
<p>is a measure of how much the model has <em>improved</em> the prediction of the outcome compared to the level of inaccuracy of the model. If a model is good, then the improvement in prediction from using the model should be large (<span class="math notranslate nohighlight">\(MS_M\)</span> will be large) and the difference between the model and the observed data should be small (<span class="math notranslate nohighlight">\(MS_R\)</span> will be small).</p>
<p>In short, for a good model the numerator in the equation above will be bigger than the denominator, resulting in a large F-statistic (greater than 1 at least).</p>
<p>This F has an associated probability distribution from which a <strong>p-value</strong> can be derived to tell us the probability of getting an F at least as big as the one we have if the null hypothesis were true. The null hypothesis in this case is a flat model (predicted values of the outcome are the same regardless of the value of the predictors).</p>
<p>The F-statistic is also used to calculate the significance of <span class="math notranslate nohighlight">\(R^2\)</span> using the following equation:</p>
<p><span class="math notranslate nohighlight">\(F = \frac{(n-p-1)R^2}{p(1-R^2)}\)</span></p>
<p>in which n is the number of cases or participants, and p is the number of predictors in the model. This F tests the null hypothesis that <span class="math notranslate nohighlight">\(R^2\)</span> is zero (i.e., there is no improvement in the sum of squared error due to fitting the model).</p>
<p>Linear Regression:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mean squared error of the model (MSE_M)</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># we only have one predictor (height_parents)</span>
<span class="n">MSM</span> <span class="o">=</span> <span class="p">(</span><span class="n">SSM</span> <span class="o">/</span> <span class="n">p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MSM =&#39;</span><span class="p">,</span> <span class="n">MSM</span><span class="p">)</span>
<span class="c1"># MSE_M of residuals from statsmodel</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MS_M = </span><span class="si">{</span><span class="n">lm</span><span class="o">.</span><span class="n">mse_model</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSM = 34.919735599622285
MS_M = 34.919735599622285
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adjust notation and calculate F-value</span>
<span class="n">MSR</span> <span class="o">=</span> <span class="n">MSE_R</span>
<span class="c1"># F-value</span>
<span class="n">F_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">MSM</span> <span class="o">/</span> <span class="n">MSR</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">F_value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>88.77567351293678
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># statsmodel</span>
<span class="c1"># Alternative way to obtain F-value (preferred)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lm</span><span class="o">.</span><span class="n">fvalue</span><span class="p">)</span>
<span class="c1"># which of course equals</span>
<span class="n">F_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">lm</span><span class="o">.</span><span class="n">mse_model</span> <span class="o">/</span> <span class="n">lm</span><span class="o">.</span><span class="n">mse_resid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">F_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>88.77567351293679
88.77567351293679
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="standard-error">
<h3>Standard error<a class="headerlink" href="#standard-error" title="Permalink to this headline">¶</a></h3>
<p>We just learned that the <strong>standard deviation</strong> tells us about how well the mean represents the sample data. However, if we’re using the <strong>sample mean</strong> to estimate this parameter in the <strong>population</strong> (like we did), then we need to know how well it represents the value in the population, especially because samples from a population differ.</p>
<p>Imagine that we were interested in the height of <em>all</em> adult women in germany (so adult women in germany are the <strong>population</strong>). We could take a <strong>sample</strong> from this population (like we did with our 20 women), and when we do we are taking one of many possible samples. If we were to take several samples from the same population, then each sample would have its own mean, and some of these sample means will be different.</p>
<p>Imagine we could obtain the height of all adult women in germany and could compute the mean of their height (which would equal <span class="math notranslate nohighlight">\(\mu\)</span> = 168 cm). Then we would know, as an absolute fact, that the mean of the height is 168 cm (this is the population mean, <strong>µ</strong>, the parameter that we’re trying to estimate).</p>
<p>In reality, we don’t have access to the population, so we use a sample. In this sample we calculate the average height, known as the <strong>sample mean</strong> (<span class="math notranslate nohighlight">\(\bar{x}\)</span>), and discover it is 168 cm; that is, adult women in our sample are 168 cm tall, on average. Now we take a second sample and find that women in this sample are, on average, only 167 cm tall. In other words, the sample mean is different in the second sample than in the first.</p>
<p>This difference illustrates <strong>sampling variation</strong>: that is, samples vary because they contain different members of the population; a sample that, by chance, includes relatively tall women will have a higher average than a sample that, by chance, includes some women who are relatively short.</p>
<p>Imagine that we now take a lot of samples (let’s say 1000). If we plotted the resulting sample means as a histogram, we would observe a symmetrical distribution known as a <strong>sampling distribution</strong>.</p>
<p>A <strong>sampling distribution</strong> is the frequency distribution of sample means (or whatever parameter you’re trying to estimate) from the same population. You need to imagine that we’re taking hundreds or thousands of samples to construct a sampling distribution.</p>
<p>The sampling distribution of the mean tells us about the behaviour of samples from the population, and it is centred at around the same value as the mean of the population. Therefore, if we took the average of all sample means we’d get the value of the <strong>population mean</strong>.</p>
<p>We can use the sampling distribution to tell us how <em>representative a sample</em> is of the population. Think back to the <strong>standard deviation</strong>. We used the standard deviation as a measure of how representative the mean was of the observed data.</p>
<p>A small standard deviation represented a scenario in which most data points were close to the mean, whereas a large standard deviation represented a situation in which data points were widely spread from the mean. If our ‘observed data’ are sample means then the standard deviation of these sample means would similarly tell us how widely spread (i.e., how representative) sample means are around their average. Bearing in mind that the <em>average of the sample means</em> is the same as the <em>population mean</em>, the standard deviation of the sample means would therefore tell us how widely sample means are spread around the population mean: put another way, it tells us whether sample means are typically representative of the population mean.</p>
<p>The standard deviation of sample means is known as the <strong>standard error of the mean (SE)</strong> or standard error for short. Theoretically, the standard error could be calculated by taking the difference between each sample mean and the overall mean, squaring these differences, adding them up, and then dividing by the number of samples. Finally, the square root of this value would need to be taken to get the standard deviation of sample means: the standard error. In the real world, it would be to costly to collect thousands of samples, and so we compute the standard error from a mathematical approximation.</p>
<p>Statisticians have demonstrated something called the <strong>central limit theorem</strong>, which tells us that as samples get large (usually defined as greater than 30), the sampling distribution has a normal distribution with a mean equal to the population mean, and we can calculate the standard deviation as follows:</p>
<div class="math notranslate nohighlight">
\[\sigma_{\bar{X}} = \frac{s} {\sqrt{N}}\]</div>
<p>Hence, if our sample is largeer than n=30 we can use the equation above to approximate the standard error (because it is the standard deviation of the sampling distribution).
Note: when the sample is relatively small (fewer than 30) the sampling distribution is not normal: it has a different shape, known as a <strong>t-distribution</strong>, which we’ll cover later.</p>
<p><strong>Summary</strong></p>
<ul class="simple">
<li><p>The standard error of the mean is the standard deviation of sample means.</p></li>
<li><p>As such, it is a measure of how representative of the population a sample mean is likely to be.</p></li>
<li><p>A large standard error (relative to the sample mean) means that there is a lot of variability between the means of different samples and so the sample mean we have might not be representative of the population mean.</p></li>
<li><p>A small standard error indicates that most sample means are similar to the population mean (i.e., our sample mean is likely to accurately reflect the population mean).</p></li>
</ul>
<p>Mean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate standard error (...we ignore the fact that our sample is small since n &lt; 30) </span>
<span class="n">se</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sem</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">se</span><span class="p">)</span>
<span class="c1"># assign se to df</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">se</span><span class="o">=</span><span class="n">se</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.33245498310218435
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># alternative way to calculate standard error (se)</span>
<span class="c1"># calculate standard deviation (s)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="c1"># calculate se</span>
<span class="n">se</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">se</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.33245498310218435
</pre></div>
</div>
</div>
</div>
<p>Linear Regression:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get standard error of parameters</span>
<span class="n">se_2</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">bse</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Standard error (SE) od model 2:&#39;</span><span class="p">,</span> <span class="n">se_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Standard error (SE) od model 2: Intercept         14.226306
height_parents     0.086190
dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="significance-testing">
<h3>Significance testing<a class="headerlink" href="#significance-testing" title="Permalink to this headline">¶</a></h3>
<p>Next, we perform a statistical hypothesis test to asssess the slope of the model:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(H_0\)</span>: <span class="math notranslate nohighlight">\(\beta_1 = 0\)</span>. The true linear model has slope zero.</p></li>
<li><p><span class="math notranslate nohighlight">\(H_A\)</span>: <span class="math notranslate nohighlight">\(\beta_1 \neq 0\)</span>. The true linear model has a slope different than zero. The height of the parents is predictive for the height of their daughter.</p></li>
</ul>
<p>We would reject <span class="math notranslate nohighlight">\(H_0\)</span> in favor of <span class="math notranslate nohighlight">\(H_A\)</span> if the data provide strong evidence that the true slope parameter (<span class="math notranslate nohighlight">\(\beta_{expected}\)</span>) is different than zero. To assess the hypothesis, we use the standard error for the estimate (<span class="math notranslate nohighlight">\(SE_\beta\)</span>), compute a test statistic, and identify the p-value.</p>
<p>The <strong>p-value</strong> is the probability of seeing an coefficient at least as extreme as our result (0.8121), had there truly been no difference between our cofficient and the expected coefficient (with a vlaue of 0.0). In other words: the p-value is the probability of obtaining a coefficient at least as extreme as the result actually observed, under the assumption that the null hypothesis is correct. Therefore, the lower p the better since a small p-value means that such an extreme observed outcome would be very unlikely under the null hypothesis.</p>
<p>In particular, the null hypothesis is rejected if the p-value is less than a pre-defined threshold value <span class="math notranslate nohighlight">\(\alpha\)</span>, which is referred to as the alpha level or significance level. By convention, we use an \alpha level of 0.05. This means we reject <span class="math notranslate nohighlight">\(H_0\)</span> if the p-value is equal or below 5%.</p>
<p>To obtain the p-value for our coefficient, we use the parameter estimate and the respective standard error to compute a <em>t statistic</em> to tell us the likelihood of the observed parameter estimates compared to some expected value under the null hypothesis:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c}
t_{N - p} = \frac{{\beta_1} - \beta_{expected}}{SE_{\hat{\beta}}}\\
t_{N - p} = \frac{{\beta_1} - 0}{SE_{\hat{\beta}}}\\
t_{N - p} = \frac{{\beta_1} }{SE_{\hat{\beta}}}
\end{array}
\end{split}\]</div>
<p><em>Review <a class="reference external" href="https://kirenz.github.io/inference/t_test.html">this notebook</a> to learn more about the t-statistic.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
         <td></td>           <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>      <td>   30.9651</td> <td>   14.226</td> <td>    2.177</td> <td> 0.043</td> <td>    1.077</td> <td>   60.853</td>
</tr>
<tr>
  <th>height_parents</th> <td>    0.8121</td> <td>    0.086</td> <td>    9.422</td> <td> 0.000</td> <td>    0.631</td> <td>    0.993</td>
</tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">lm</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">as_html</span><span class="p">(),</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">t_statistic</span> <span class="o">=</span> <span class="n">model_result</span><span class="p">[</span><span class="s1">&#39;coef&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">model_result</span><span class="p">[</span><span class="s1">&#39;std err&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;t-statistic:&quot;</span><span class="p">,</span> <span class="n">t_statistic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t-statistic: 9.443023255813955
</pre></div>
</div>
</div>
</div>
<p>We see that the intercept is significantly different from zero (which is not of importance) and that the effect of <code class="docutils literal notranslate"><span class="pre">height_parents</span></code> on <code class="docutils literal notranslate"><span class="pre">height</span></code> is  significant (p = .000).</p>
<p>To obtain this result, we first computed the t statistic by deviding the coefficient with the standard error and found that t = 9.422. The question that we want to ask next is: What is the likelihood that we would find a t statistic of this size, if the true coefficent value is zero (i.e. the null hypothesis)?</p>
<p>We can use the t distribution to determine this probability. The result P&gt;|t| = 0.000 is the probability of finding a value of the t statistic greater than or equal to our observed value under the assumption of <span class="math notranslate nohighlight">\(H_0\)</span>. We find that p(t &gt; 9.422) = 0.000, which tells us that our observed t statistic value of 9.422 is relatively unlikely if the null hypothesis really is true.</p>
<p>Since the p-value is below our significance level of 5%, we reject <span class="math notranslate nohighlight">\(H_0\)</span>.</p>
<p>To learn more about the concept of p-values, review this excellent post series <a class="reference external" href="https://netflixtechblog.com/decision-making-at-netflix-33065fa06481">“Decision Making at Netflix”</a> provided by Netflix Tech Blog.</p>
</div>
<div class="section" id="confidence-interval">
<h3>Confidence interval<a class="headerlink" href="#confidence-interval" title="Permalink to this headline">¶</a></h3>
<p>Now let’s cover confidence intervalls. As a brief recap, we usually use a <strong>sample value</strong> as an estimate of a <strong>parameter</strong> (e.g., the mean or any other parameter b) in the <strong>population</strong>. We’ve just seen that the <strong>estimate of a parameter</strong> (e.g., the mean) will differ across samples, and we can use the <strong>standard error</strong> to get some idea of the extent to which these estimates differ across samples. We can also use this information to calculate boundaries within which we believe the population value will fall. Such boundaries are called <strong>confidence intervals</strong>.</p>
<p>For example, perhaps we might want to know how often, <em>in the long run</em>, an interval contains the true value of the parameter we’re trying to estimate (in the case of model 1, the mean). This is what a <strong>confidence interval</strong> does.</p>
<p>Typically, we look at 95% confidence intervals, and sometimes 99% confidence intervals, but they all have a similar interpretation: they are limits constructed such that, for a certain percentage of samples (be that 95% or 99%), the true value of the population parameter falls within the limits. So, when you see a 95% confidence interval for a mean, think of it like this:</p>
<ul class="simple">
<li><p>if we’d collected 100 samples, and for each sample calculated the parameter (e.g. the mean) and a confidence interval for it, then for 95 of these samples, the confidence interval contains the value of the parameter (e.g. the mean) in the population, and in 5 of the samples the confidence interval does not contain the population paramater (e.g. the mean).</p></li>
</ul>
<p>The trouble is, you do not know whether the confidence interval from a particular sample is one of the 95% that contain the true value or one of the 5% that do not.</p>
<p>Here is an example of a common wrong interpretation of confidence intervalls:</p>
<ul class="simple">
<li><p><strong>Wrong</strong> interpretation: a 95% confidence interval has a 95% probability of containing the population parameter.</p></li>
</ul>
<p>It is a common mistake, but this is <em>not</em> true. The 95% reflects a <em>long-run probability</em>. It means that if you take repeated samples and construct confidence intervals, then 95% of them will contain the population value. That is not the same as a particular confidence interval for a specific sample having a 95% probability of containing the value. In fact, for a specific confidence interval, the probability that it contains the population value is either 0 (it does not contain it) or 1 (it does contain it). You have no way of knowing which it is.</p>
<p>We know (in large samples) that the sampling distribution of parameters (e.g. means) will be normal, and the <strong>normal distribution</strong> has been precisely defined such that it has a mean of 0 and a standard deviation of 1. We can use this information to compute the probability of a score occurring, or the limits between which a certain percentage of scores fall.</p>
<p>We make use of the fact that 95% of <strong>z-scores</strong> fall between −1.96 and 1.96. This means that if our sample parameters (e.g. means) were normally distributed with a mean of 0 and a standard error of 1, then the limits of our confidence interval would be −1.96 and +1.96. Luckily we know from the <strong>central limit theorem</strong> that in large samples (above about 30) the sampling distribution will be normally distributed.</p>
<p><strong>Visualize confidence intervals in plots</strong></p>
<p>We saw that confidence intervals provide us with information about a parameter, and, therefore, you often see them displayed on graphs.</p>
<p>The confidence interval is usually displayed using something called an <strong>error bar</strong>, which looks like the letter ‘I’. An error bar can represent the <strong>standard deviation</strong>, or the <strong>standard error</strong>, but more often than not it shows the <strong>95% confidence interval</strong> of the mean. So, often when you see a graph showing the mean, perhaps displayed as a bar or a symbol, it is accompanied by this I-shaped bar.</p>
<p>Model 1: The Mean</p>
<p>First of all, we convert scores so that they have a mean of 0 and standard deviation of 1 (<strong>z-scores</strong>) using this equation:</p>
<div class="math notranslate nohighlight">
\[z = \frac{X-\bar{X}}{s}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate z-scores</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">zscore</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="c1"># assign z-scores to df</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    -2.070197
1    -1.380131
2    -1.380131
3    -0.690066
4    -0.690066
5    -0.690066
6    -0.690066
7     0.000000
8     0.000000
9     0.000000
10    0.000000
11    0.000000
12    0.000000
13    0.690066
14    0.690066
15    0.690066
16    0.690066
17    1.380131
18    1.380131
19    2.070197
Name: height, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span>

<span class="c1"># draw a vertical line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">1.96</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>

<span class="c1"># add text</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span><span class="s1">&#39;z = 1.96&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="mf">1.96</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span><span class="s1">&#39;z = -1.96&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_103_0.png" src="../_images/basics_103_0.png" />
</div>
</div>
<p>If we know that our limits are −1.96 and 1.96 as z-scores, then to find out the corresponding scores in our raw data we can replace z in the equation (because there are two values, we get two equations):</p>
<div class="math notranslate nohighlight">
\[1.96 = \frac{X-\bar{X}}{s}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[-1.96 = \frac{X-\bar{X}}{s}\]</div>
<p>We rearrange these equations to discover the value of X:</p>
<div class="math notranslate nohighlight">
\[1.96 \times s = X - \bar{X}\]</div>
<div class="math notranslate nohighlight">
\[(1.96 \times s) + \bar{X} = X\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[-1.96 \times s = X - \bar{X}\]</div>
<div class="math notranslate nohighlight">
\[(-1.96 \times s) + \bar{X} = X\]</div>
<p>Therefore, the confidence interval can easily be calculated once the <strong>standard deviation</strong> (s in the equation) and <strong>mean</strong> (<span class="math notranslate nohighlight">\(\bar{x}\)</span> in the equation) are known.</p>
<p>However, we use the <strong>standard error</strong> and not the standard deviation because we’re interested in the variability of sample means, not the variability in observations within the sample.</p>
<p>The lower boundary of the confidence interval is, therefore, the mean minus 1.96 times the standard error, and the upper boundary is the mean plus 1.96 standard errors:</p>
<p><strong>lower boundary of confidence intervall</strong> = <span class="math notranslate nohighlight">\(\bar{X} - (1.96 \times SE)\)</span></p>
<p><strong>upper boundary of confidence intervall</strong> = <span class="math notranslate nohighlight">\(\bar{X} + (1.96 \times SE)\)</span></p>
<p>As such, the mean is always in the centre of the confidence interval. We know that 95% of confidence intervals contain the population mean, so we can assume this confidence interval contains the true mean; therefore, if the interval is small,the sample mean must be very close to the true man. Conversely, if the confidenve interval is very wide then the sample mean could be very different from the true mean, indicating that it is a bad representation of the population.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># lower boundary</span>
<span class="n">lb</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.96</span><span class="o">*</span><span class="n">se</span><span class="p">))</span>
<span class="c1"># upper boundary</span>
<span class="n">up</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.96</span><span class="o">*</span><span class="n">se</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Lower boundary of CI&#39;</span><span class="p">,</span> <span class="n">lb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Upper boundary of CI&#39;</span><span class="p">,</span> <span class="n">up</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lower boundary of CI 164.34838823311972
Upper boundary of CI 165.65161176688028
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># draw limits of confidence intervall</span>
<span class="n">plt</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span>
<span class="c1"># draw a vertical line to mark the mean </span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">165</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
<span class="c1"># add text</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">165.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span><span class="s1">&#39;Mean = 165&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
<span class="c1"># draw a vertical line to mark the lower limit of the confidence intervall</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">164.348388</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="c1"># add text</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">164</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;Lower limit = 164.34 &#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="c1"># draw a vertical line to mark the upper limit of the confidence intervall</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">165.651612</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">165.8</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;Upper limit = 165.65&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_106_0.png" src="../_images/basics_106_0.png" />
</div>
</div>
<p>Model 2: Linear Regression</p>
<p>Confidence intervall for parameter <span class="math notranslate nohighlight">\(b_1\)</span> (height_parents)</p>
<p><strong>lower boundary of confidence intervall</strong> = <span class="math notranslate nohighlight">\(b_1 - (1.96 \times SE(b_1))\)</span></p>
<p><strong>upper boundary of confidence intervall</strong> = <span class="math notranslate nohighlight">\(b_1 + (1.96 \times SE(b_1))\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtain confidence interval for fitted parameters </span>
<span class="n">lm</span><span class="o">.</span><span class="n">conf_int</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>1.076702</td>
      <td>60.853420</td>
    </tr>
    <tr>
      <th>height_parents</th>
      <td>0.631009</td>
      <td>0.993165</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a prediction for height when parents average height is 168 cm</span>
<span class="n">to_predict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;height_parents&#39;</span><span class="p">:[</span><span class="mi">168</span><span class="p">]})</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">(</span><span class="n">to_predict</span><span class="p">)</span>
<span class="nb">round</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>mean_se</th>
      <th>mean_ci_lower</th>
      <th>mean_ci_upper</th>
      <th>obs_ci_lower</th>
      <th>obs_ci_upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>167.4</td>
      <td>0.29</td>
      <td>166.79</td>
      <td>168.01</td>
      <td>165.94</td>
      <td>168.85</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>The predicted height for an average parents height of 168 cm is 167.4.</p></li>
<li><p>For 95% the confidence interval is [166.79, 168.01] and the prediction interval is [165.94, 168.85]</p></li>
</ul>
<p>How much will the outcome vary from our prediction? We use <strong>prediction intervals</strong> (obs_ci_lower and obs_ci_uppper) to answer this question. Prediction intervals are always wider than confidence intervals, because they incorporate both the error in the estimate for f(X) (the reducible error) and the uncertainty as to how much an individual point will differ from the population regression (the irreducible error).</p>
<p>We interpret this to mean that 95% of intervals of this form will contain the true value of Y for parents with this average height. Note that both intervals are centered at 167.4 cm, but that the <strong>prediction interval</strong> is substantially wider than the confidence interval, reflecting the increased uncertainty about the individual height for given parents height in comparison to the average height of many parents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot regression line with CI 95%</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;height_parents&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">},</span> <span class="n">height</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mi">95</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_113_0.png" src="../_images/basics_113_0.png" />
</div>
</div>
</div>
<div class="section" id="confidence-intervals-in-small-samples">
<h3>Confidence intervals in small samples<a class="headerlink" href="#confidence-intervals-in-small-samples" title="Permalink to this headline">¶</a></h3>
<p>The procedure we just used is fine when samples are large, because the central limit theorem tells us that the sampling distribution will be normal. However, for small samples, the sampling distribution is not normal – it has a t-distribution. The t-distribution is a family of probability distributions that change shape as the sample size gets bigger (when the sample is very big, it has the shape of a normal distribution).</p>
<p>To construct a confidence interval in a small sample we use the same principle as before, but instead of using the value for z we use the value for t:</p>
<p>lower boundary of confidence intervall = <span class="math notranslate nohighlight">\(\bar{X} - (t_{n-1} \times SE)\)</span></p>
<p>upper boundary of confidence intervall = <span class="math notranslate nohighlight">\(\bar{X} + (t_{n-1}  \times SE)\)</span></p>
<p>The (n − 1) in the equations is the degrees of freedom and tells us which of the t-distributions to use. For a 95% confidence interval, we can calculate the value of t for a two-tailed test with probability of 0.05, for the appropriate degrees of freedom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate t-statistic</span>
<span class="c1"># 95% confidence interval, two tailed test, </span>
<span class="c1"># p&lt;0.05 (we need to take 0.025 at each side), n=20, df=19</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.025</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="c1"># lower boundary</span>
<span class="n">lb_t</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">se</span><span class="p">))</span>
<span class="c1"># upper boundary</span>
<span class="n">up_t</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">se</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Lower boundary of CI (t-statistics)&#39;</span><span class="p">,</span> <span class="n">lb_t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Upper boundary of CI (t-statistics)&#39;</span><span class="p">,</span> <span class="n">up_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.093024054408263
Lower boundary of CI (t-statistics) 164.30416372335924
Upper boundary of CI (t-statistics) 165.69583627664076
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># draw limits of confidence intervall for t-statistic</span>
<span class="n">plt</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span>
<span class="c1"># draw a vertical line to mark the mean </span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">165</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
<span class="c1"># add text</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">165.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span><span class="s1">&#39;Mean = 165&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
<span class="c1"># draw a vertical line to mark the lower limit of the confidence intervall</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">164.304164</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="c1"># add text</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">164</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;Lower limit = 164.30 &#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="c1"># draw a vertical line to mark the upper limit of the confidence intervall</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">165.695836</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">165.8</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;Upper limit = 165.69&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_116_0.png" src="../_images/basics_116_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compare CI z-statistic with t-statistic</span>
<span class="c1"># draw limits of confidence intervall</span>
<span class="n">plt</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span>
<span class="c1"># draw a vertical line to mark the mean </span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">165</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
<span class="c1"># add text</span>
<span class="c1"># draw vertical lines to mark the lower/upper limit of the confidence intervall (z)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">164.348388</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">165.651612</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">);</span>
<span class="c1"># draw vertical lines to mark the lower/upper limit of the confidence intervall (t)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">164.304164</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">165.695836</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basics_117_0.png" src="../_images/basics_117_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="additional-measures">
<h2>Additional measures<a class="headerlink" href="#additional-measures" title="Permalink to this headline">¶</a></h2>
<p>When fitting models, it is possible to increase the likelihood by adding parameters, but doing so may result in overfitting.</p>
<p>Both the Bayesian information criterion (<strong>BIC</strong>) (also called the Schwarz criterion SBC or SBIC) and Akaike information criterion (<strong>AIC</strong>) attempt to resolve this problem by introducing a penalty term for the number of parameters in the model; the penalty term is larger in BIC than in AIC.</p>
<p>Both measures are an estimator of the <strong>relative quality</strong> of statistical models for a given set of data. Hence, they are used to select the best performing model.</p>
<p>For both measures, <strong>lower</strong> values are better</p>
<div class="section" id="bayesian-information-criterion-bic">
<h3>Bayesian information criterion (BIC)<a class="headerlink" href="#bayesian-information-criterion-bic" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># BIC</span>
<span class="n">lm</span><span class="o">.</span><span class="n">bic</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>41.980585438104086
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="akaike-information-criterion-aic">
<h3>Akaike information criterion (AIC)<a class="headerlink" href="#akaike-information-criterion-aic" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># AIC</span>
<span class="n">lm</span><span class="o">.</span><span class="n">aic</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>39.989120890996105
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Welcome</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="diagnostics.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Regression diagnostics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Jan Kirenz<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>